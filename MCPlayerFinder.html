<!DOCTYPE html>
<html>
 <head>
  <meta name="viewport" 
   content="width=device-width, 
   initial-scale=1.0, 
   maximum-scale=1.0,
   minimum-scale=1.0, 
   user-scalable=no">
  <title>通过选择器查找玩家</title>
  <meta charset="utf-8">
  <div class="center">
   <h1>玩家查找器v0.2</h1>
   <h3>猴某人(HTMG)制作</h3>
  </div>
  <style>
   .center{
     text-align: center;
   }
   .center2{
	    height: 75px;
   }
   #pic{
     width: 100%;
   }
   #ctrl{
     width: 100%;
	    height: 50px;
     border-style: none;
     background-color: #f3ff94;
   }
   #yes{
     width: 100%;
	    height: 33%;
     border-style: none none solid none;
     border-color: #c1a072;
     background-color: #f3ff94;
   }
   #no{
     width: 100%;
	    height: 33%;
     border-style: none;
     background-color: #f3ff94;
   }
   #result{
     width: 100%;
     height: 50px;
     background-color: #f7ffb9;
     border-style: solid;
     border-color: #c1a072;
     font-size: 15px;
     text-align: center;
   }
   #state{
     width: 98%;
     height: 20px;
     background-color: #f7ffb9;
     border-style: solid;
     border-color: #c1a072;
     font-size: 15px;
     text-align: center;
   }
   #step{
     width: 98%;
     height: 20px;
     background-color: #f7ffb9;
     border-style: solid;
     border-width: 2px;
     border-color: #c1a072;
     font-size: 15px;
     text-align: center;
   }
  </style>
 </head>

 <body style="background-color:#f7ffb9">
  <div class="center">
   <input type="button" onclick="start()" id="ctrl" value="开始">
   <br>
   <input type="text" id="state" readonly>
   <br>
   <input type="text" id="step" readonly>
   <div>
    <input id="result" readonly>复制指令到聊天框</textarea>
   </div>
   <div class="center2">
    选中的玩家中是否有目标玩家
    <button onclick="Y()" id="yes">有</button>
    <br>
    <button onclick="N()" id="no">无</button>
    <br>
    <button onclick="settings()">
     点按打开设置
    </button>
   </div>
   <div class="settings" style="display:none">
    <input type="text" id="value" value="100000">
   </div>
  </div>

<script>
/*
  1 状态及其含义列表
  STANDBY  待命
  QUADRANT1 - QUADRANT4  象限查找
  DETAIL1  细分:左半
  DETAIL2  细分:下半
*/
</script>
  
<script>
/* 数据存储变量 */
var Cmd = [ '/w @s @a[', ']' ],
    CORNER = [ 0, 0, 0 ],
    DELTA = [ 0, 0, 0 ],
    Step = 0,
    State = 'STANDBY';

/* 功能性变量 */
var Out = document.getElementById('result');
var state = document.getElementById("state");
var step = document.getElementById("step");

function Update(){
  step.innerHTML = "步数: " + Step;
  state.innerHTML = "状态: " + State;
  
  if(State != 'STANDBY'){
    Out.innerHTML = CMD('CORNER', [ CORNER[0], CORNER[1],
      CORNER[2], DELTA[0],
      DELTA[1], DELTA[2]
    ]);
  }
}

function start(){
  if(State == 'STANDBY'){
    State = 'QUADRANT1';
	   DELTA = [ 10000000, 512, 10000000 ];
    
	document.getElementById('ctrl').value = '复位';
    if(State != 'STANDBY'){
      Out.innerHTML = CMD('CORNER', [ CORNER[0], CORNER[1], CORNER[2], DELTA[0], DELTA[1], DELTA[2] ]);
    }

    Update();
  } else {
    reset();
  }
}

function Y(){
  switch(State){
    case 'QUADRANT1':
	     DELTA[0] = Math.floor(DELTA[0] / 2);
	     State = 'DETAIL1';
	     break;
    case 'QUADRANT2':
	     DELTA[0] = Math.floor(DELTA[0] / 2);
	     State = 'DETAIL1';
	     break;
    case 'QUADRANT3':
	     DELTA[0] = Math.floor(DELTA[0] / 2);
	     State = 'DETAIL1';
	     break;
    case 'QUADRANT4':
	     DELTA[0] = Math.floor(DELTA[0] / 2);
	     State = 'DETAIL1';
	     break;
    case 'DETAIL1':
      DELTA[2] = Math.floor(DELTA[2] / 2);
	     State = 'DETAIL2';
	     break;
    case 'DETAIL2':
      DELTA[0]  = Math.floor(DELTA[0] / 2);
	     State = 'DETAIL1';
	     break;
  }
  
  if(State != 'STANDBY')Step++;
  if(State != 'STANDBY'){
    Out.innerHTML = CMD('CORNER', [ CORNER[0], CORNER[1], CORNER[2], DELTA[0], DELTA[1], DELTA[2] ]);
  }

  Update();
}

function N(){
  switch(State){
    case 'QUADRANT1':
      DELTA = [ -10000000, 512, 10000000 ];
	     State = 'QUADRANT2';
      break;
    case 'QUADRANT2':
      DELTA = [ -10000000, 512, -10000000 ];
      State = 'QUADRANT3';
      break;
    case 'QUADRANT3':
  	   DELTA = [ 10000000, 512, -10000000 ];
	     State = 'QUADRANT4';
	     break;
    case 'QUADRANT4':
	     State = 'ERROR_NO_PLAYER_FOUND';
	     break;
	   case 'DETAIL1':
      CORNER[0] += DELTA[0];
	     DELTA[2] = Math.floor(DELTA[2] / 2);
	     State = 'DETAIL2';
	     break;
	   case 'DETAIL2':
	     CORNER[2] += DELTA[2];
	     DELTA[0] = Math.floor(DELTA[0] / 2);
	     State = 'DETAIL1';
	     break;
  }
  
  if(State != 'STANDBY')Step++;
  if(State != 'STANDBY'){
    Out.innerHTML = CMD('CORNER', [ CORNER[0], CORNER[1], CORNER[2], DELTA[0], DELTA[1], DELTA[2] ]);
  }

  Update();
}

function reset(){
  State = 'STANDBY';
  Out.innerHTML = '复制指令到聊天框';
  CORNER = [ 0, 0, 0 ];
  DELTA = [ 0, 0, 0 ];
  Step = 0;
  
  document.getElementById('ctrl').value = '开始';

  Update();
}

function CMD(type, param){
  var r;
  switch(type){
    case 'CENTER':
      r = Cmd[0] + 'x=' + param[0]
                 + ',y=' + param[1]
                 + ',z=' + param[2]
                 + ',r=' + param[3]
                 + Cmd[1];
      break;
    case 'CORNER':
      r = Cmd[0] + 'x=' + param[0]
                 + ',y=' + param[1]
                 + ',z=' + param[2]
                 + ',dx=' + param[3]
                 + ',dy=' + param[4]
                 + ',dz=' + param[5]
                 + Cmd[1];
      break;
  }

  return r;
}
</script>

</body>
</html>